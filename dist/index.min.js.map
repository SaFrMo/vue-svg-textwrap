{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.min.js","sourcesContent":["import Vue from 'vue';\nfunction getConfig(mod, cfg) {\n\tconst ret = {\n\t\t'plain': !cfg.plain ? false : true,\n\t\t'width': null || cfg.width,\n\t\t'align': cfg.align || 'baseline',\n\t\t'lineHeight': cfg.lineHeight || '1.125em',\n\t\t'paddingLeft': cfg.paddingLeft === undefined ? (cfg.padding === undefined ? 0 : cfg.padding) : cfg.paddingLeft,\n\t\t'paddingRight': cfg.paddingRight === undefined ? (cfg.padding === undefined ? 0 : cfg.padding) : cfg.paddingRight\n\t};\n\tret.padding = ret.paddingLeft + ret.paddingRight;\n\tfor (let k in mod) {\n\t\tif (k === 'plain') ret.plain = true;\n\t\telse if (k === 'baseline' || k === 'top' || k === 'bottom' || k === 'middle' || k === 'none')\n\t\t\tret.align = k;\n\t\telse if (/\\d+/.test(k))\n\t\t\tret.width = parseInt(k);\n\t}\n\treturn ret;\n}\nfunction newLine(el, span, config) {\n\tconst tmp = span.cloneNode();\n\tel.insertBefore(tmp, span.nextSibling);\n\tspan.style.display = null;\n\ttmp.setAttribute('dy', config.lineHeight);\n\ttmp.setAttribute('x', config.paddingLeft);\n\treturn tmp;\n}\n/**\n * @param {SVGTextElement} el \n * @param {String} text \n * @param {Object} config \n */\nfunction set(el, text, config) {\n\tel[config.plain ? 'textContent' : 'innerHTML'] = text || '';\n\tif (!config.width) return;\n\tconst plain = [];\n\tconst physLn = el.getBBox().height; // physical line height\n\t// convert text nodes to tspans, clear spans\n\tel.childNodes.forEach(function (n) {\n\t\tif (n instanceof Text) {\n\t\t\tconst tmp = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\n\t\t\ttmp.textContent = n.textContent;\n\t\t\tel.replaceChild(tmp, n);\n\t\t\tn = tmp;\n\t\t}\n\t\tplain.push(n.textContent.split(' '));\n\t\tn.textContent = '';\n\t});\n\tif (el.childElementCount) {\n\t\tel.childNodes[0].setAttribute('y', 0);\n\t\tel.childNodes[0].setAttribute('x', config.paddingLeft);\n\t}\n\n\t// float texts\n\tlet offset = 0, w = config.width - config.padding, childCnt = el.childElementCount;\n\tfor (let c = 0; c < childCnt; c++) {\n\t\tconst words = plain[c];\n\t\tlet wc = words.length, span = el.childNodes[c + offset], txt = '', forceBreak = false;\n\t\tfor (let i = 0; i < wc; i++) {\n\t\t\tspan.textContent += i ? ' ' + words[i] : words[i];\n\t\t\tforceBreak = el.getBBox().width > w;\n\t\t\twhile (forceBreak) {\n\t\t\t\tspan.textContent = txt;\n\t\t\t\tspan = newLine(el, span, config);\n\t\t\t\ttxt = span.textContent = words[i];\n\t\t\t\toffset++;\n\t\t\t\tif (el.getBBox().width > w) {\n\t\t\t\t\tspan.style.display = 'none'; // too long word, hide for further correct measurements\n\t\t\t\t\ttxt = words[++i];\n\t\t\t\t\tif (!txt) forceBreak = false;\n\t\t\t\t} else forceBreak = false;\n\t\t\t}\n\t\t\ttxt = span.textContent;\n\t\t}\n\t}\n\tel.childNodes.forEach(function (n) { n.style.display = null })\n\tif (config.align === 'middle')\n\t\tel.setAttribute('transform', `translate(0, -${(el.getBBox().height - physLn) / 2})`)\n\telse if (config.align === 'baseline')\n\t\tel.setAttribute('transform', `translate(0, -${config.lineHeight - physLn})`)\n\telse if (config.align === 'bottom')\n\t\tel.setAttribute('transform', `translate(0, -${el.getBBox().height - physLn})`)\n\telse if (config.align === 'top')\n\t\tel.setAttribute('transform', `translate(0, ${physLn})`)\n}\n\n/**\n * Creates a new wrapper directive with the given configuration.\n * @param {ITextWrapperConfiguration} config A configuration object.\n */\nfunction directive(config) {\n\tif (!config) config = {};\n\treturn {\n\t\tinserted(el, binding) {\n\t\t\tif (!(el instanceof SVGTextElement))\n\t\t\t\tthrow new Error('Text-wrap directive must be bound to an SVG text element.');\n\t\t\tel.__WRAP_CONFIG = getConfig(binding.modifiers, config);\n\t\t\tset(el, binding.value, el.__WRAP_CONFIG);\n\t\t},\n\t\tupdate(el, binding) {\n\t\t\tset(el, binding.value, el.__WRAP_CONFIG);\n\t\t},\n\t\tunbind(el) {\n\t\t\tdelete el.__WRAP_CONFIG;\n\t\t}\n\t}\n}\nconst Wrapper = directive();\nexport default Wrapper;\n\nexport const ConfiguredWrapper = directive;"]}