{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.pf.min.js","sourcesContent":["function getConfig(mod, cfg) {\n\tconst ret = {\n\t\t'plain': !cfg.plain ? false : true,\n\t\t'width': null || cfg.width,\n\t\t'align': cfg.align || 'baseline',\n\t\t'lineHeight': cfg.lineHeight || '1.125em',\n\t\t'paddingLeft': cfg.paddingLeft === undefined ? (cfg.padding === undefined ? 0 : cfg.padding) : cfg.paddingLeft,\n\t\t'paddingRight': cfg.paddingRight === undefined ? (cfg.padding === undefined ? 0 : cfg.padding) : cfg.paddingRight,\n\t\t'afterReflow': cfg.afterReflow instanceof Function ? cfg.afterReflow : false\n\t};\n\tret.padding = ret.paddingLeft + ret.paddingRight;\n\tfor (let k in mod) {\n\t\tif (k === 'plain') ret.plain = true;\n\t\telse if (k === 'baseline' || k === 'top' || k === 'bottom' || k === 'middle' || k === 'none')\n\t\t\tret.align = k;\n\t\telse if (/\\d+/.test(k))\n\t\t\tret.width = parseInt(k);\n\t}\n\treturn ret;\n}\n/**\n * @param {SVGTextElement} el \n * @param {SVGTSpanElement} span \n * @param {*} config \n */\nfunction newLine(el, span, config) {\n\tconst tmp = span.cloneNode();\n\tel.insertBefore(tmp, span.nextSibling);\n\tspan.style.display = null;\n\ttmp.removeAttribute('y');\n\ttmp.setAttribute('dy', config.lineHeight);\n\ttmp.setAttribute('x', config.paddingLeft);\n\treturn tmp;\n}\n/**\n * @param {SVGTextElement} el \n * @param {String} text \n * @param {Object} config \n */\nfunction set(el, text, config) {\n\tel[config.plain ? 'textContent' : 'innerHTML'] = text || '';\n\tif (!config.width) return;\n\tconst plain = [];\n\tconst physLn = el.getBBox().height; // physical line height\n\t// convert text nodes to tspans, clear spans\n\tfor (let i = 0; i < el.childNodes.length; i++) {\n\t\tlet n = el.childNodes[i];\n\t\tif (n instanceof Text) {\n\t\t\tconst tmp = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\n\t\t\ttmp.textContent = n.textContent;\n\t\t\tel.replaceChild(tmp, n);\n\t\t\tn = tmp;\n\t\t}\n\t\tplain.push(n.textContent.split(' '));\n\t\tn.textContent = '';\n\t}\n\tif (el.childElementCount) {\n\t\tel.childNodes[0].setAttribute('y', 0);\n\t\tel.childNodes[0].setAttribute('x', config.paddingLeft);\n\t}\n\n\t// float texts\n\tlet offset = 0, w = config.width - config.padding, childCnt = el.childElementCount;\n\tfor (let c = 0; c < childCnt; c++) {\n\t\tconst words = plain[c];\n\t\tlet wc = words.length, span = el.childNodes[c + offset], txt = '', forceBreak = false;\n\t\tfor (let i = 0; i < wc; i++) {\n\t\t\tspan.textContent += i ? ' ' + words[i] : words[i];\n\t\t\tforceBreak = el.getBBox().width > w;\n\t\t\twhile (forceBreak) {\n\t\t\t\tspan.textContent = txt;\n\t\t\t\tspan = newLine(el, span, config);\n\t\t\t\ttxt = span.textContent = words[i];\n\t\t\t\toffset++;\n\t\t\t\tif (el.getBBox().width > w) {\n\t\t\t\t\tspan.style.display = 'none'; // too long word, hide for further correct measurements\n\t\t\t\t\ttxt = words[++i];\n\t\t\t\t\tif (!txt) forceBreak = false;\n\t\t\t\t} else forceBreak = false;\n\t\t\t}\n\t\t\ttxt = span.textContent;\n\t\t}\n\t}\n\n\tfor (let i = 0; i < el.childNodes.length; i++)\n\t\tel.childNodes[i].style.display = null;\n\n\tif (config.align === 'middle')\n\t\tel.setAttribute('transform', `translate(0, -${(el.getBBox().height - physLn) / 2})`)\n\telse if (config.align === 'baseline')\n\t\tel.setAttribute('transform', `translate(0, -${config.lineHeight - physLn})`)\n\telse if (config.align === 'bottom')\n\t\tel.setAttribute('transform', `translate(0, -${el.getBBox().height - physLn})`)\n\telse if (config.align === 'top')\n\t\tel.setAttribute('transform', `translate(0, ${physLn})`)\n}\n\n/**\n * Creates a new wrapper directive with the given configuration.\n * @param {ITextWrapperConfiguration} config A configuration object.\n */\nfunction directive(config) {\n\tif (!config) config = {};\n\tconst r = {\n\t\tinserted(el, binding) {\n\t\t\tif (!(el instanceof SVGTextElement))\n\t\t\t\tthrow new Error('Text-wrap directive must be bound to an SVG text element.');\n\t\t\tel.__WRAP_CONFIG = getConfig(binding.modifiers, config);\n\t\t\tr.update.apply(this, arguments);\n\t\t},\n\t\tupdate(el, binding, { context }) {\n\t\t\tif (binding.value !== binding.oldValue) {\n\t\t\t\tlet cfg = el.__WRAP_CONFIG\n\t\t\t\tif (binding.value && (typeof binding.value) !== 'string') {\n\t\t\t\t\tconst text = binding.value.text;\n\t\t\t\t\tcfg = Object.assign({}, el.__WRAP_CONFIG, binding.value)\n\t\t\t\t\tset(el, text, cfg);\n\t\t\t\t} else\n\t\t\t\t\tset(el, binding.value, cfg);\n\t\t\t\tif (cfg.afterReflow)\n\t\t\t\t\tcfg.afterReflow.call(context, el, cfg);\n\t\t\t}\n\t\t},\n\t\tunbind(el) {\n\t\t\tdelete el.__WRAP_CONFIG;\n\t\t}\n\t};\n\treturn r;\n}\nconst Wrapper = directive();\nexport default Wrapper;\n\nexport const ConfiguredWrapper = directive;"]}